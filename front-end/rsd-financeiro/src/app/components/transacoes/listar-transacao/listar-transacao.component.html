<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Transações</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <a routerLink="nova-transacao" class="btn btn-sm btn-outline-primary">Nova Transação</a>
        </div>
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-primary"
                (click)="listarTodos(0, constants.MAX_GRID_RECORDS)"><i class="bi-arrow-clockwise"></i></button>
        </div>
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-primary">Importar</button>
            <button type="button" class="btn btn-sm btn-outline-primary">Exportar</button>
        </div>
    </div>
</div>
<div class="accordion" id="accordionFlushExample">
    <div class="accordion-item" *ngFor="let transacao of transacoes; let i = index">
        <h2 class="accordion-header" [id]="'collpaseheader' + i">
            <div [class]="i == 0 ? 'accordion-button' : 'accordion-button collapsed'" data-bs-toggle="collapse"
                [attr.data-bs-target]="'#collpaseitem' + i" aria-expanded="false"
                [attr.aria-controls]="'collpaseitem' + i" type="button">
                <div class="col">
                    <b>Data:</b> {{transacao.data | date: 'dd/MM/yyyy': '-03:00'}} - {{transacao.codigo}} -
                    {{transacaoService.buscarDescricaoPorCodigo(transacao.codigo).descricao}}
                    <br /><b>Histórico:</b> {{transacao.historico}} <i *ngIf="transacao.documento!.base64"
                        class="bi-file-code-fill text-danger"></i>
                </div>
            </div>
        </h2>
        <div [id]="'collpaseitem' + i" [class]="i == 0 ? 'accordion-collapse collapse' : 'accordion-collapse collapse'"
            [attr.aria-labelledby]="'collpaseheader' + i" data-bs-parent="#accordionFlushExample">
            <div class="accordion-body">
                <div class="row w-100">
                    <div class="col">
                        <b>Complemento:</b> {{transacao.complemento}}
                    </div>
                    <div class="col-3 col-md-1 text-end">
                        <button class="btn btn-sm btn-outline-primary no-border"><i class="bi-pencil"></i></button>
                        <button class="btn btn-sm btn-outline-danger no-border"><i class="bi-trash"></i></button>
                    </div>
                </div>
                <table class="table table-sm table-hover">
                    <thead>
                        <tr>
                            <th scope="col" class="col">Evento</th>
                            <th scope="col" class="col-2 text-end">Valor</th>
                            <th scope="col" class="col-1 text-center">Moeda</th>
                            <th scope="col" class="col-1 text-end">Natureza</th>
                            <th scope="col" class="col-2 text-end">Centro de Custos</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor='let evento of transacao.eventos'>
                            <td class="col nowrap">{{transacao.codigo}}.{{evento.codigo}} -
                                {{eventosService.buscarDescricaoPorCodigo(evento.codigo).descricao}}</td>
                            <td class="col-2 text-end text-primary" *ngIf="evento.natureza == 'E'">
                                {{evento.valor!.valor | formatarNumero}}</td>
                            <td class="col-2 text-end text-danger" *ngIf="evento.natureza == 'S'">
                                ({{evento.valor!.valor | formatarNumero}})</td>
                            <td class="col-1 text-center">{{evento.valor!.moeda!}}</td>
                            <td class="col-1 text-end">{{evento.natureza == 'E' ? 'Entrada' : 'Saída'}}</td>
                            <td class="col-2 text-center">{{evento.centroCustos!}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="table-responsive">
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-end">
            <li class="page-item">
                <a class="page-link" (click)="listarTodos(0, 6)" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" *ngFor="let item of paginas; let i = index" (click)="listarTodos(i, constants.MAX_GRID_RECORDS)">
                <a class="page-link">{{item + 1}}</a>
            </li>
            <li class="page-item">
                <a class="page-link" (click)="listarTodos(ultimaPagina, constants.MAX_GRID_RECORDS)" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>